package {	import flash.display.DisplayObjectContainer;	import flash.display.DisplayObject;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;	import flash.text.TextFormat;	import flash.events.Event;	import flash.utils.Timer;	import flash.events.TimerEvent;	import TweenImageLoader;	import XMLloader;		import com.flashdynamix.motion.*;	import fl.motion.easing.*;	//コンストラクタ	public class XMLSlideShow {		var targetContainer:DisplayObjectContainer;		var titleFld:TextField;		var xmlLoader:XMLloader;		var photoXml:XML;		var imgLoader:TweenImageLoader;		var currentNo:int;		var timerObj:Timer;		var photoPath = "photo/"				//コンストラクタ		function XMLSlideShow(container:DisplayObjectContainer, url:String) {			targetContainer = container;			creatCaptionFld();			//ShiftJISに対応			var isUnicode:Boolean = false;			//XMLファイルを読み込む			xmlLoader = new XMLloader(url, isUnicode);			xmlLoader.addEventListener(XMLloader.LOAD_COMPLETE, onXMLloaded);			currentNo = 0;					}		//タイトル用のテキストフィールドを作る		function creatCaptionFld():void{			titleFld = new TextField();			titleFld.autoSize = TextFieldAutoSize.LEFT;			var textFormat:TextFormat = new TextFormat();			textFormat.size = 18;			titleFld.defaultTextFormat = textFormat;			titleFld.x = targetContainer.x;			titleFld.y = targetContainer.y-25;			targetContainer.stage.addChild(titleFld);		}		//XML読み込み完了		function onXMLloaded(event:Event):void {			photoXml = xmlLoader.getXML();			var delay:int = 8000;			playSlideShow(delay);		}		//スライドショーの再生開始		public function playSlideShow(delay:int) {			if(currentNo == 0){				currentNo = 1;				loadImageNo(1)			}			//スライド更新のタイマー			timerObj = new Timer(delay);			timerObj.addEventListener(TimerEvent.TIMER, nextImage);			timerObj.start();		}		//次の写真を読み込む		function nextImage(event:TimerEvent):void {			//currentNoのカウントアップ			currentNo = (currentNo>=photoXml.photo.length())?1:(currentNo+1);			loadImageNo(currentNo);		}		//写真を読み込んで表示する		function loadImageNo(imgNo:int):void {			var element:XML = photoXml.photo[imgNo - 1];			//タイトルを表示する			titleFld.text = element.toString();			//ファイル名を取り出す			var url:String = photoPath + element.@fname;			//写真の読み込み〜フェードイン表示			imgLoader = new TweenImageLoader(targetContainer, url, 0,0);			//フェードイン終了イベントにリスナー登録する			imgLoader.addEventListener(TweenImageLoader.TWEEN_FINISH, onTweenFinish);		}		//フェードイン完了。下に隠れた写真を破棄する		function onTweenFinish(event:Event):void {			if (targetContainer.numChildren >= 2) {				var prevPhoto:DisplayObject=targetContainer.getChildAt(0);				targetContainer.removeChildAt(0);				prevPhoto=null;			}		}	}}